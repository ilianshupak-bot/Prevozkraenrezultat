<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <title>EuroTrans - –ö–æ–Ω—Ç–∞–∫—Ç–∏</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="nav-container">
            <a href="index.html"><img src="logo.png" alt="EuroTrans Logo" class="logo-img"></a>
            <nav>
                <ul>
                    <li><a href="index.html" id="nav-home">–ù–∞—á–∞–ª–æ</a></li>
                    <li><a href="routes.html" id="nav-routes">–ú–∞—Ä—à—Ä—É—Ç–∏</a></li>
                    <li><a href="schedule.html" id="nav-schedule">–†–∞–∑–ø–∏—Å–∞–Ω–∏–µ</a></li>
                    <li><a href="fleet.html" id="nav-fleet">–ê–≤—Ç–æ–ø–∞—Ä–∫</a></li>
                    <li><a href="contact.html" class="active" id="nav-contact">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a></li>
                    <li><select class="lang-select" onchange="changeLanguage(this.value)"><option value="bg">üáßüá¨</option><option value="en">üá¨üáß</option><option value="ru">üá∑üá∫</option><option value="ua">üá∫üá¶</option></select></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <h1 class="page-title" id="contact-title">–°–≤—ä—Ä–∂–µ—Ç–µ —Å–µ —Å –Ω–∞—Å</h1>
        
        <div class="grid" style="grid-template-columns: 1fr 1.5fr;">
            <div class="card">
                <h3 id="contact-info-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <p id="contact-phones">
                    üìû <strong>BG:</strong> +359 888 123 456<br>
                    üìû <strong>MD:</strong> +373 69 123 456
                </p>
                <br>
                <p>üìß office@eurotrans.com</p>
                <br>
                <p id="contact-address">üìç –û—Ñ–∏—Å –°–æ—Ñ–∏—è: –±—É–ª. –í–∏—Ç–æ—à–∞ 10</p>
            </div>

            <div class="content-box">
                <h2 id="form-title">–†–µ–∑–µ—Ä–≤–∞—Ü–∏—è / –ó–∞–ø–∏—Ç–≤–∞–Ω–µ</h2>
                <form action="#" method="POST" id="booking-form">
                    
                    <div style="margin-bottom: 15px;">
                        <label for="name" style="display:block; margin-bottom:5px;">–ò–º–µ –∏ –§–∞–º–∏–ª–∏—è</label>
                        <input type="text" id="name" name="name" style="width: 100%;" required>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <label for="phone" style="display:block; margin-bottom:5px;">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="text" id="phone" name="phone" style="width: 100%;" required>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <label for="travel-date" style="display:block; margin-bottom:5px;">–î–∞—Ç–∞ –Ω–∞ –ø—ä—Ç—É–≤–∞–Ω–µ</label>
                        <select id="travel-date" name="travel-date" style="width: 100%;" onchange="updateRouteBasedOnDate()">
                            </select>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <label for="route" style="display:block; margin-bottom:5px;">–ú–∞—Ä—à—Ä—É—Ç</label>
                        <select id="route" name="route" style="width: 100%;">
                            <option value="sofia-moldova">–°–æ—Ñ–∏—è ‚ûî –ú–æ–ª–¥–æ–≤–∞</option>
                            <option value="moldova-sofia">–ú–æ–ª–¥–æ–≤–∞ ‚ûî –°–æ—Ñ–∏—è</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <label for="message" style="display:block; margin-bottom:5px;">–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
                        <textarea id="message" name="message" rows="4" style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid #e5e7eb; background:#f9fafb;"></textarea>
                    </div>

                    <button type="submit" class="btn" style="width: 100%;" id="btn-send">–ò–∑–ø—Ä–∞—Ç–∏</button>
                </form>
            </div>
        </div>
    </main>

    <script type="module" src="auth.js"></script>
    <script src="lang.js"></script>

    <script>
        // 1. –§—É–Ω–∫—Ü–∏—è –∑–∞ –Ω–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ —Å–ª–µ–¥–≤–∞—â–∏—è –¥–µ–Ω –æ—Ç —Å–µ–¥–º–∏—Ü–∞—Ç–∞ (5 = –ü–µ—Ç—ä–∫, 0 = –ù–µ–¥–µ–ª—è)
        function getNextDayOfWeek(date, dayOfWeek) {
            const resultDate = new Date(date.getTime());
            resultDate.setDate(date.getDate() + (7 + dayOfWeek - date.getDay()) % 7);
            
            // –ê–∫–æ –¥–Ω–µ—Å –µ —Ç—ä—Ä—Å–µ–Ω–∏—è –¥–µ–Ω, –º–æ–∂–µ –¥–∞ –∏—Å–∫–∞–º–µ —Å–ª–µ–¥–≤–∞—â–∞—Ç–∞ —Å–µ–¥–º–∏—Ü–∞ –∏–ª–∏ –¥–Ω–µ—Å. 
            // –¢—É–∫ —Å–ª–∞–≥–∞–º–µ –ø—Ä–æ—Å—Ç–∞ –ª–æ–≥–∏–∫–∞: –∞–∫–æ –µ –¥–Ω–µ—Å, –æ—Å—Ç–∞–≤–∞ –¥–Ω–µ—Å.
            return resultDate;
        }

        // 2. –§–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞—Ç–∞—Ç–∞ (–î–î.–ú–ú)
        function formatDate(date) {
            let d = date.getDate();
            let m = date.getMonth() + 1;
            return (d < 10 ? '0'+d : d) + '.' + (m < 10 ? '0'+m : m);
        }

        // 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ
        window.addEventListener('DOMContentLoaded', () => {
            const dateSelect = document.getElementById('travel-date');
            const routeSelect = document.getElementById('route');
            const today = new Date();

            // –ù–∞–º–µ—Ä–∏ —Å–ª–µ–¥–≤–∞—â–∏—è –ü–µ—Ç—ä–∫ (–¥–µ–Ω 5)
            let nextFriday = getNextDayOfWeek(today, 5);
            // –ê–∫–æ –¥–Ω–µ—Å –µ –ø–µ—Ç—ä–∫ –∏ –µ –º–∏–Ω–∞–ª–æ 16:00, –º–æ–∂–µ –¥–∞ –≤–∑–µ–º–µ—à –ø–æ-—Å–ª–µ–¥–≤–∞—â–∏—è, –Ω–æ –Ω–µ–∫–∞ –µ –ø—Ä–æ—Å—Ç–æ
            if (today.getDay() === 5 && today.getHours() >= 16) {
                nextFriday.setDate(nextFriday.getDate() + 7);
            }

            // –ù–∞–º–µ—Ä–∏ —Å–ª–µ–¥–≤–∞—â–∞—Ç–∞ –ù–µ–¥–µ–ª—è (–¥–µ–Ω 0)
            let nextSunday = getNextDayOfWeek(today, 0);
            if (today.getDay() === 0 && today.getHours() >= 8) {
                nextSunday.setDate(nextSunday.getDate() + 7);
            }

            // –î–æ–±–∞–≤–∏ –æ–ø—Ü–∏–∏—Ç–µ –≤ —Å–µ–ª–µ–∫—Ç–∞
            // Option 1: –ü–µ—Ç—ä–∫
            let optFri = document.createElement('option');
            optFri.value = 'friday';
            optFri.text = `–ü–µ—Ç—ä–∫ (${formatDate(nextFriday)})`;
            dateSelect.add(optFri);

            // Option 2: –ù–µ–¥–µ–ª—è
            let optSun = document.createElement('option');
            optSun.value = 'sunday';
            optSun.text = `–ù–µ–¥–µ–ª—è (${formatDate(nextSunday)})`;
            dateSelect.add(optSun);

            // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ (–∞–∫–æ –∏–¥–≤–∞–º–µ –æ—Ç Schedule —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞)
            const urlParams = new URLSearchParams(window.location.search);
            const dayParam = urlParams.get('day');

            if (dayParam === 'friday') {
                dateSelect.value = 'friday';
            } else if (dayParam === 'sunday') {
                dateSelect.value = 'sunday';
            }

            // –ò–∑–≤–∏–∫–≤–∞–º–µ –ª–æ–≥–∏–∫–∞—Ç–∞ –≤–µ–¥–Ω—ä–∂ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç
            updateRouteBasedOnDate();
        });

        // 5. –õ–æ–≥–∏–∫–∞: –°–º—è–Ω–∞ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∞ —Å–ø–æ—Ä–µ–¥ –¥–∞—Ç–∞—Ç–∞
        function updateRouteBasedOnDate() {
            const dateSelect = document.getElementById('travel-date');
            const routeSelect = document.getElementById('route');
            const selectedValue = dateSelect.value;

            // –ù—É–ª–∏—Ä–∞–º–µ –≤—Å–∏—á–∫–∏ –æ–ø—Ü–∏–∏ –¥–∞ —Å–∞ –≤–∏–¥–∏–º–∏ –ø—ä—Ä–≤–æ
            for (let i = 0; i < routeSelect.options.length; i++) {
                routeSelect.options[i].disabled = false;
                routeSelect.options[i].hidden = false;
            }

            if (selectedValue === 'friday') {
                // –ê–∫–æ –µ –ü–µ—Ç—ä–∫ -> –°–∞–º–æ –°–æ—Ñ–∏—è –∫—ä–º –ú–æ–ª–¥–æ–≤–∞
                routeSelect.value = 'sofia-moldova';
                // –°–∫—Ä–∏–≤–∞–º–µ/–î–µ–∞–∫—Ç–∏–≤–∏—Ä–∞–º–µ –¥—Ä—É–≥–∞—Ç–∞ –æ–ø—Ü–∏—è
                for (let i = 0; i < routeSelect.options.length; i++) {
                    if (routeSelect.options[i].value === 'moldova-sofia') {
                        routeSelect.options[i].disabled = true;
                    }
                }
            } else if (selectedValue === 'sunday') {
                // –ê–∫–æ –µ –ù–µ–¥–µ–ª—è -> –°–∞–º–æ –ú–æ–ª–¥–æ–≤–∞ –∫—ä–º –°–æ—Ñ–∏—è
                routeSelect.value = 'moldova-sofia';
                // –°–∫—Ä–∏–≤–∞–º–µ/–î–µ–∞–∫—Ç–∏–≤–∏—Ä–∞–º–µ –¥—Ä—É–≥–∞—Ç–∞ –æ–ø—Ü–∏—è
                for (let i = 0; i < routeSelect.options.length; i++) {
                    if (routeSelect.options[i].value === 'sofia-moldova') {
                        routeSelect.options[i].disabled = true;
                    }
                }
            }
        }
    </script>
</body>
</html>